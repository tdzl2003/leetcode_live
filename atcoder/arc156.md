A. 分类讨论边界题。设1的个数为K

* 如果K为奇数，无解，因为奇偶性不会改变。
* 如果K为偶数且K>=4，总是有解，且步数为K/2，因为错开的情况（前一半和后一半依次匹配）总能满足距离>=2
* 如果只有1对1：
    * 若两个1之间距离>=1，步数为1
    * 若N=3，且A[1]=1，无解，因为其不能参与反转。
    * 若N=4，且A[1]=A[2]=1，步数为3，可以通过两侧间接完成
    * 否则，步数为2，总能找到一个距离两个1均>=2的点辅助完成。

B. 组合题，首先无需考虑原本已经出现的数，仅考虑新增的数；其次假设新增的数中出现了之前集合没包含的数，则必要包含所有更小的没包含的数。

遍历第i大（从0开始计算）的没被原集合包含的数M，比它小的原集合没出现的数共有i个，这i个必须包含；其余的K-i数在1到M-1之间任意选择，采用多重组合公式求解即可。

多重组合公式：mc(n,k) = c(n+k-1,k)

C. 构造题。

首先很容易证明similarity不可能小于1，因为若根为r，则必有一条路径同时经过r和Pr，其similarity至少为1 。

然后经过尝试，可以找到一种办法必然构造出similarity=1的排列。

以某个点为根，考虑任意一条路径，其深度必然是从高到低（不一定到整棵树的根），再从低到高。

若相同深度总是有多个点，且相同深度的点轮换自己的序号，则任意一条路径的后一半，相同深度时要么不出现前一半对应节点的序号，要么出现但是在路径上反序，无法找到两个点的序号按照路径的顺序出现在Px序列中。

下面考虑如何保证除了根以外每层深度都至少有2个点。考虑图的直径，若直径长度为奇数，选其中点为根，可构造满足要求的解。若直径长度为偶数，选中间的两个点为“双根”，视作相同深度，同样构造即可。这样构造出来的树，至少存在两个子树拥有最大深度，因此每个深度都有至少一个顶点。

