[比赛链接](https://atcoder.jp/contests/abc303/tasks)

## A

简单题，按题意逐位对比即可

## B

简单题，用一个全表记录每一个相邻对是否出现过，用总数 $\frac{N(N-1)}{2}$ 减去出现过的不同对数即可。

## C

模拟题，按题意模拟即可。需要注意的是和很多游戏/其它题目不同，这题血量变成负数了才死。

## D

DP题，滚动DP每天记录两个状态，分别是当日以Capslock激活状态结束的代价 和 以Capslock未激活状态结束的代价。

## E

图论题。因为得到的是一个树，所以显然会有很多度为1的节点，并且这些节点都属于原来某个星的边缘。

可以发现，把任意一个度为1的节点当做根，此时深度为2的节点都是星的中心，深度为3的节点都是星的边缘，深度为4的节点是另一个星的边缘，深度为5的节点是另一个星的中心……

因此从任意一个度为1的节点出发DFS，所有深度满足 $depth\bmod 3=2$ 的点都是星的中心，他们的度都是原来星的等级，整理并输出即可。

> 群友提供了另一个也可行的思路是数一下度大于2的星星，剩下的星星都是度为2的

> 勇敢的少年可以选择拓扑排序过这题，不是不可以（

## F

首先考虑每回合的最佳策略，如果我们知道还剩下多少个回合，我们就可以确定当前回合每一个技能所能造成的总计伤害：

$$
min(t_i, rounds) * d_i
$$

我们可以把技能分成两类：

* $t_i\gt rounds$ ，这类技能中我们只需要考虑最大的 $d_i$
* $t_i\le rounds$ ，这类技能中我们只需要考虑最大的 $t_i*d_i$

对每一回合来说，我们只要比较上述两个技能那个更优即可。

接下来我们考虑如何计算最小的总回合数。显然回合数越大可以造成的总伤害越多，该函数单调，所以我们可以二分查找总回合数，并计算总的伤害数是否能够击杀魔王。

接下来我们考虑如何判断总的伤害能否击杀魔王。

我们按技能的回合数排序，考虑剩余回合数处于每个回合数的区段中的时候，区段中哪些技能属于哪一类是确定的，所以我们可以分别求出前述两类技能的最大 $d_i$ 和 最大 $t_j*d_j$ ，我们可以看出，前一类技能随着回合数减少而减少，直到某一时刻 后者变得更优。因此每个区段的最佳策略可能被分为两个部分，其中一部分是由最大 $d_i$ 组成的等差数列，另一部分是由最大 $t_j*d_j$ 组成的固定伤害。两部分我们都可以采用公式求解，判断是否成功击杀魔王。

注意一个区段的伤害最大可能是 $10^9*10^9*10^9$ ，大于 `long long` 类型的表示范围，所以要么选择使用 __int128 （或其它超过64位的大整数方案），要么选择把乘法判断转变为除法。

我们并不需要尝试减去一个上述大整数，我们只需要判断它是否小于当前剩余血量。如果小于，那么显然该数字仍在 `long long` 范围内，可以直接计算。

我们可以采取如下方法变形 $rounds * dmg \ge h$ 的判断：

$$
\begin{aligned}
rounds * dmg &\ge h \\
rounds &\ge \frac{h}{dmg} \\
rounds &\ge \lceil\frac{h}{dmg}\rceil \\
rounds &\gt \lfloor\frac{h-1}{dmg}\rfloor \\
\end{aligned}
$$

> 其实从结束开始倒数，每回合的最佳伤害是确定的，可以由此构造一个复杂度更优的算法。但我赛中为了更方便的处理等差数列，还是选择整体框架做二分查找，这样每个等差数列的范围都是确定的，更易判断和求解。
