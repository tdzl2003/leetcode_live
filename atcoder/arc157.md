## [A - XXYYX](https://atcoder.jp/contests/arc157/tasks/arc157_a)

问题转化为有向图中是否存在一个欧拉道路，所以显然必须有：

* $B\le C+1, C \le B+1$ 否则B和C中有一个无法完成。
* 若 $A\gt 0$ 且 $D\gt 0$，则必有 $B+C \gt 0$ ，否则X点和Y点不连通。

在符合的情况下，均可以顺利构造出答案，选B和C中较大的一方作为起点（若都大于0且相等，则任意一个作为起点，若都等于0，则根据A和D的情况决定起点），任意构造即可。

## [B - XYYYX](https://atcoder.jp/contests/arc157/tasks/arc157_b)

首先考虑 $K \le count(X)$ 的情形，假设原本至少有一个Y，每次操作至少可以增加一对。如果某次操作连通了两个Y，那么该次操作可以增加两对。因此如下构造贪心策略：

* 将所有两侧有Y的X区段 按从小到大的顺序填满（填满一个即可获得一个额外收益）

还需处理边界情况：若 $count(Y) = 0$ ，那么答案最多为 $max(0, K-1)$


如果 $K > count(X)$ ，考虑先翻转所有元素，之后还原 $N-K$ 个，可变形为 $K \le count(X)$ 的情形


## [C - YY Square](https://atcoder.jp/contests/arc157/tasks/arc157_c)

得分是相邻Y对数的平方，考虑第 $i$ 对连续的Y，其贡献是 $i^2 - (i-1)^2 = 2*i - 1$

考虑每增加一对Y，得分分两种情况：

* 如果当前是首对Y，每组组合得分+1
* 如果当前不是首对Y，每组组合得分比之前的一对增加2

因此可以维护其得到一对Y时能新增的得分。对于一对Y的路线，可以加上 所有该路线的组合*2 - 首对Y的组合

采用四个DP数组共同完成任务：

* A: 到当前位置所有路线的组合，等于 C(i+j, i)
* B: 到当前位置能得到的得分总合
* C: 到当前位置，再遇到一对新的Y能够提供的得分
* D: 到当前位置尚未出现连续Y的组合

可以在 $O(H*W)$ 时间内完成DP推导。

[代码](https://atcoder.jp/contests/arc157/submissions/39190300)

## [D - YY Garden](https://atcoder.jp/contests/arc157/tasks/arc157_d)

设总共设置了 $hc-1$ 个水平栅栏和 $wc-1$ 个垂直栅栏，首先注意到它将原图划分成 $hc$ 行和 $wc$ 列，那么按题意每格里都有2个Y，所以总计有 $count(Y) = 2 * hc * wc$

因此可以枚举 $\frac{count(Y)}{2}$ 的所有因子，进行尝试。

我们可以分别考虑水平栅栏和垂直栅栏的设置可能组合数，因为水平栅栏恰好将所有的Y分成 $hc$ 组，每组数量为 $2*wc$ ，垂直栅栏则将所有的Y分为 $wc$ 组，每组数量为 $2*wc$ 。这样我们可以用DP+双指针在 $O(H+W)$时间内分别求出两个组合数。

注意这样考虑并不表示一定存在合法组合，因为有可能Y恰好集中在某两个对角中。但是可以注意到相同 $hc, wc$ 的所有的方案之间，栅栏的移动不能越过任何的Y（否则会导致单独考虑一个维度时的数量就已经不符合要求），因此我们只要任意选择一种组合进行完整验证，就可以保证所有的组合都是合法的。整体复杂度为 $O(HW+k(H+W+y))$。其中k是因子的数目，y是每次验证的复杂度。

[代码](https://atcoder.jp/contests/arc157/submissions/39197500)