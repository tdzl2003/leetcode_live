## T1

简单题，暴力就可以符合时间要求，但是其实利用T4结论可以 $O(1)$ 求出每个数参与的子数组数量，最后总计在 $O(N)$ 时间内求出，这里先卖个关子。

## T2

因为是子序列，其实和元素的顺序没有关系，直接将数组排序，然后从小到大处理。

考虑大小处于第 $i$ 位（和代码统一这里 $i$ 从0开始）的元素，其作为最小值的贡献次数，相当于在其后的 $n-i$ 个元素中选择至多 $k-1$ 个，而作为最大值的贡献次数，相当于在之前的 $i-1$ 个元素中选择至多 $k-1$ 个，所以下面的问题在于如何求所有的：

$$
f(x) = \sum_{i=0}^{x}{i \choose k-1}
$$

这里可采用组合的方法来递推思考：考虑已知 $f(x)$ ，现在增加一个元素，对之前的每个方案，这个元素都可以选择或者不选择，但是要排除掉之前已经选满了 $k-1$ 个元素的情况，也就是：

$$
f(x) = f(x-1)\times 2 - {x-1\choose k-1}
$$

这样就可以在 $O(N)$ 时间递推求出所有的 $f(x)$ 。整体复杂度包含了一个排序，也就是 $O(NlgN)$ 

当然，题目 $k$ 限制的比较小，直接 $O(Nk)$ 暴力求解似乎也可以通过

## T3

DP问题，需要仔细梳理状态，确保保存的状态维度比较小，可以成对的处理房屋的颜色，从内侧向外侧DP 或 从外侧向内侧DP均可，复杂度 $O(N\times3^4)$

## T4

和T2思路类似，计算每个数的贡献，我们可以利用线段树标记，来得到 左边界 和 右边界 （最近的比它更小/更大的数出现的位置），然后看看有多少个组合 包含当前的数

这个组合的最好的思考方法是 采用容斥，即：整个范围中子数组的数量，减去 左边不包含自己的子数组的数量，再减去右边范围不包含自己的子数组数量。

容易看出这每个数量都是一个等差数列求和，采用公式可以 $O(1)$ 得出。

整体复杂度包括排序和线段树，为 $O(NlgN)$ 