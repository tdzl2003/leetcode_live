[Div.2 比赛链接](https://www.luogu.com.cn/contest/83892)
[Div.1 比赛链接](https://www.luogu.com.cn/contest/103328)

# Div1. T1

简单题，按题意单独处理三进制最低位及后面每一位即可：

* 最低位为2无解
* 除最低位外，每有一位为1，答案增加2倍。

# Div1. T2

表面上是个大整数题，其实建议为了快速的shift，不要套模板。

用一个 `vector<int> bits` 来存放所有的位，每个int存放32位，并用一个`int rest`来记录最后未使用的位。

* shift时，如果仍由未使用的位，直接将其减一。否则插入一个新的int，并`rest = 31`
* 增加时，将 `d << rest` 之后再参与运算。

# Div1. T3/Div2. T1

设 $DP[n][m]$ 为总共 $2n$ 张牌，其中 $m$ 张不同的已知牌的期望得分。

* 如果 $m=0$ ，那么只能翻开两张未知牌。如果正好命中两张相同，那么得一分并继续 $1 + DP[n-1][0]$ 否则让给对手并且产生两张已知牌 $n - DP[n][2]$
* 否则总是应当翻开一张未知牌和一张已知牌 （翻开两张未知牌总是命中概率更低并且未命中时有概率给对手送出2分），命中时得分并继续 $1 + DP[n-1][m-1]$ 否则有机会让给对手1分（和现有已知牌相同） $n-1 - DP[n-1][m-1]$ 或暴露一张新的已知牌 $i - DP[n][m+1]$
* 注意如果场上至少有2张已知牌，并且按上述策略己方得分低于 $\frac{n}{2}$ ，那么总是可以翻开2张已知牌而不改变状态。此时进入平均，得分为 $\frac{n}{2}$ 

上述递推可按 $n$ 从小到大 $m$ 从大到小顺序计算，正确计算每一种情况的概率即可完成本题。