
## B

按题意进行DP模拟，采用（倍数替代分解质因数）的技巧，可以做到 $O(nk\lg{n})$ 的时间复杂度，足以通过本题。

下面来讲如何进一步优化时间复杂度。

* 观察DP的过程，我们会发现每次转移时，当 $b_{i-1}\mid b_i$ 时，产生贡献。
* 如果我们一次性考虑多步转移，会发现如下结论：
    * 首先 $b_j \mid b_i$ 时 ( $j<i$ ) 产生贡献
    * 考虑 $d = \frac{b_i}{b_j}$ ，假设d的质因数分解为 $d=p_1^{a_1}p_2^{a_2}...$ ，可以看出，每一个质因数 $p_i$ 的 $a_i$ 个，可以分布在 $\frac{b_{j+1}}{b_j}$ 、$\frac{b_{j+2}}{b_{j+1}}$ 这 $j-i$ 个桶中，并且不同质因数的分布独立。每个质因数的组合数即为（多重组合问题，请回忆八球问题） ${j-i+a_i-1 \choose a_i}$ 将其乘起即可。
    * 因此，我们可以直接枚举 $a_1，a_k$ （注意符合条件的仅有 $n\ln{n}$ 种组合），将其商分解质因数并求组合，复杂度为 $O(n\lg ^2{n} + k)$
* 更进一步的，我们可以在数列前面增加固定的 $a_0=1$ ，它不改变合法数列的数量，这样我们仅需要枚举 $a_k$ ，复杂度为 $O(nlgn + k)$
* 最后，我们可以进一步思考分解质因数的过程：
    * 我们采用埃筛或者欧筛获取质数表时，可以顺便获取每个数字的“最小质因数”
    * 假设 $j = \frac{i}{minPrime[i]}$ ，可以看出，分为两种情况：
        * $minPrime[i] \mid j$ ，此时 $i$ 中该质因子数量为 $j$ 中该质因子数量+1 ，且此时必有 $minPrime[j] = minPrime[i]$
        * $minPrime[i] \nmid j$ ，此时必有 $minPrime[j] > minPrime[i]$ ，因此该质因子数量为1
    * 因此，我们可以 $O(n)$ 迭代时，记录每个数“最小质因子的数量” ，而不关心其它质因子的数量。迭代时，如果引入了新的最小质因子，则结果在上次结果上乘以 ${k \choose 1} = k$ 。否则，设最小质因子指数为 $a$ ，则结果在上次结果上乘上 $\frac{(k+a-1)\choose a}{(k+a-2) \choose (a-1)} = \frac{k+a-1}{a}$
    * 该方法可以在 $O(n+k)$ 时间完成。