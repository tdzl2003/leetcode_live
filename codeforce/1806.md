[比赛链接](https://codeforces.com/contest/1806)

# A

简单题，按题意做好判断即可。为了让思路更清晰，可以分两个步骤来进行，每个步骤的执行次数都大于等于0即可。

# B

脑筋急转弯证明题，思路关键在于如何构造尽量小的MEX

* 如果0的数量少于或等于 $\lceil\frac{n}{2}\rceil$ 个，那么总是可以将其间隔摆放，从而让MEX=0
* 否则，如果全是0，或者有至少有一个比1大的数，那么总是可以将0和1隔开，从而让MEX=1
* 否则，因为总有过半的0，我们可以在0之间夹杂着出现一个1，最后0后面跟一个1，再跟上其它数，这样MEX=2

所以不必考虑更大的MEX，根据上述情况分类讨论即可。

# C

分类讨论题，可以猜测数字越大越难出现异常解，可以找到所有可能的解：

* $n=1$ ，且 $p_1=p_2$
* $n=2$ ，且 $p=(2,2,2,2)$ 
* $p_i=0$
* n为偶数，且有一个数为n，其余的均为-1。这样包含n的组合为1，积为-n；不包含n的组合和为-n，积为1 。

经过枚举可以发现不存在其它的情况，并且n越大越不太可能出现新的情况。

因此将原数组排序，和上述每一组进行比较，选择最小的差异即可。

# D

组合计数题。

依次考虑每一个点，它能够产生一个向1的边 当且仅当：

* $a_{p_i-1} = 0$ ，即，连接时是向前连接
* $r_{p_i-1} = 1$ ，即，之前的连通块已经以1为根。

其中条件2 当且仅当：

* 从 0 .. i-1 都已经连接成一个连通块。
* 每次和包含1的连通块相连，都是1作为根。

这次的条件2 当且仅当：

* 对每个 $a_{p_i}=1$ ，连接后该连通块都还没有和1连接

这当且仅当：

* 对每个 $a_{p_i}=1$ ，存在一个 $j$ 满足 $j \gt i, p_j\lt p_i, a_{p_j} = 0$

考虑迭代的解决此题：

* $ans=0, valid=1$ ， $ans$ 表示最终的结果，即为输出， $valid$ 表示到目前为止所有元素都已经连通并还能保持1作为根的组合数。
* 针对每一个i，进行如下操作：

  * $ans = ans * i$ ：表示对之前所有的组合，增加最后一个元素后都变成 $i$ 个组合（对应增加的元素放在不同的i个位置，这都不会改变之前的得分），对应的得分也乘以 $i$ 。
  * 如果 $a_i=0$ ，加上该连通块能够计分的组合数 $ans = ans + validCnt$ 表示之前的所有元素都已经连通并保持1作为根的组合，都可以在该位置得到1分。
  * 如果 $a_i=0$ ， $validCnt = validCnt * i$ 表示不管该位置能不能得分，只要能顺利连通，仍然能保持1作为根。
  * 如果 $a_i=1$ ， $validCnt = validCnt * (i-1)$ 表示对前 $i$ 个元素来说，该位置不能最后一个和1相连（会导致1不再作为根）。所有validCnt的组合 最后都是将某个连通块连到0上，所以只要不最后一个合并 $i$ ，就能保证1仍然作为根。

进行如上迭代操作，可以在 $O(N)$ 时间完成所有的计算。同时将每个ans输出即可。
